<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Source Writer v3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #F1F5F9; color: #334155; }
        
        /* Markdown Styles */
        .prose h1 { font-size: 1.8em; font-weight: 700; margin-bottom: 0.5em; color: #1e293b; border-bottom: 2px solid #cbd5e1; }
        .prose h2 { font-size: 1.5em; font-weight: 700; margin-top: 1.5em; margin-bottom: 0.5em; color: #334155; background: #e2e8f0; padding: 0.5em; border-left: 5px solid #6366f1; }
        .prose h3 { font-size: 1.25em; font-weight: 600; margin-top: 1.2em; margin-bottom: 0.5em; color: #475569; border-bottom: 1px solid #e2e8f0; }
        .prose p { margin-bottom: 1em; line-height: 1.8; }
        .prose ul, .prose ol { padding-left: 1.5em; margin-bottom: 1em; list-style: disc; }
        
        /* Custom UI */
        .glass-panel { background: white; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .tab-active { border-bottom: 2px solid #6366f1; color: #6366f1; font-weight: bold; }
        .tab-inactive { color: #64748b; cursor: pointer; }
        .tab-inactive:hover { color: #334155; background-color: #f8fafc; }
        
        .loader { border: 3px solid #f3f3f3; border-radius: 50%; border-top: 3px solid #6366f1; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <h1 class="text-xl font-bold tracking-tight text-gray-800 flex items-center gap-2">
                    <span class="text-2xl">ğŸ“š</span> Source Based Writer <span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded">v3</span>
                </h1>
                
                <!-- Model Selector -->
                <select id="modelSelect" class="text-xs bg-gray-100 border border-gray-300 rounded px-2 py-1 focus:outline-none focus:border-indigo-500">
                    <option value="gemini-1.5-flash">Model: gemini-1.5-flash (æ¨å¥¨)</option>
                    <option value="gemini-1.5-flash-001">Model: gemini-1.5-flash-001</option>
                    <option value="gemini-1.5-flash-002">Model: gemini-1.5-flash-002</option>
                    <option value="gemini-1.5-pro">Model: gemini-1.5-pro</option>
                    <option value="gemini-1.5-pro-001">Model: gemini-1.5-pro-001</option>
                </select>
            </div>
            
            <div class="flex items-center gap-4">
                <button onclick="clearApiKey()" class="text-xs text-gray-400 hover:text-red-400 underline">APIã‚­ãƒ¼è¨­å®š</button>
            </div>
        </div>
    </header>

    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full space-y-8">

        <!-- API Key Modal -->
        <div id="apiKeyModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden">
            <div class="bg-white p-8 rounded-xl max-w-md w-full shadow-2xl">
                <h2 class="text-xl font-bold text-gray-800 mb-4">åˆæœŸè¨­å®š</h2>
                <p class="text-gray-500 text-sm mb-4">Gemini APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
                <input type="password" id="inputApiKey" placeholder="sk-..." class="w-full bg-gray-50 border border-gray-300 rounded px-4 py-2 mb-4 focus:border-indigo-500 outline-none">
                <button onclick="saveApiKey()" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 rounded transition">ä¿å­˜ã—ã¦é–‹å§‹</button>
                <p class="text-xs text-center mt-4 text-gray-400"><a href="https://aistudio.google.com/app/apikey" target="_blank" class="underline">APIã‚­ãƒ¼ã‚’å–å¾—ã™ã‚‹</a></p>
            </div>
        </div>

        <!-- Step 1: Source Input -->
        <section id="inputSection" class="glass-panel p-8 rounded-xl max-w-4xl mx-auto">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">å…ƒãƒ‡ãƒ¼ã‚¿ã‚’é¸æŠ</h2>
            
            <!-- Tabs -->
            <div class="flex justify-center mb-6 border-b border-gray-200">
                <button onclick="switchTab('pdf')" id="tab-pdf" class="tab-active px-6 py-2 transition-colors w-1/2 md:w-auto">ğŸ“„ PDFè³‡æ–™</button>
                <button onclick="switchTab('text')" id="tab-text" class="tab-inactive px-6 py-2 transition-colors w-1/2 md:w-auto">ğŸ“ ãƒ†ã‚­ã‚¹ãƒˆ / URL</button>
            </div>

            <!-- PDF Input -->
            <div id="panel-pdf" class="space-y-4">
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-10 text-center hover:bg-gray-50 transition-colors relative h-48 flex flex-col items-center justify-center">
                    <input type="file" id="pdfFile" accept="application/pdf" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" onchange="handleFileSelect(this)">
                    <div id="fileLabel">
                        <span class="text-4xl block mb-2">ğŸ“‚</span>
                        <span class="text-gray-500 font-bold">PDFã‚’ã“ã“ã«ãƒ‰ãƒ­ãƒƒãƒ—</span>
                        <p class="text-xs text-gray-400 mt-2">ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ (10MBä»¥ä¸‹)</p>
                    </div>
                </div>
            </div>

            <!-- Text/URL Input -->
            <div id="panel-text" class="space-y-4 hidden">
                <textarea id="rawText" rows="8" class="w-full bg-gray-50 border border-gray-300 rounded-lg p-4 focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="ã“ã“ã«å‚è€ƒã‚µã‚¤ãƒˆã®æ–‡ç« ã‚’ã‚³ãƒ”ãƒšã™ã‚‹ã‹ã€è³‡æ–™ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."></textarea>
                <p class="text-xs text-gray-500">â€»URLã‚’å…¥åŠ›ã™ã‚‹å ´åˆã¯ã€ãã®ãƒšãƒ¼ã‚¸ã®å†…å®¹ï¼ˆãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã“ã“ã«è²¼ã‚Šä»˜ã‘ã‚‹ã®ãŒæœ€ã‚‚ç¢ºå®Ÿã§ã™ã€‚</p>
            </div>

            <div class="mt-8 text-center">
                <button onclick="analyzeSource()" id="analyzeBtn" class="bg-indigo-600 hover:bg-indigo-500 text-white font-bold px-8 py-3 rounded-full shadow-md transition-all flex items-center gap-2 mx-auto disabled:opacity-50 disabled:cursor-not-allowed">
                    <span>è§£æãƒ»ã‚¿ã‚¤ãƒˆãƒ«æ¡ˆå‡ºã—</span>
                    <span id="analyzeIcon">âœ¨</span>
                </button>
            </div>
        </section>

        <!-- Status Bar -->
        <div id="statusSection" class="hidden max-w-4xl mx-auto">
            <div class="bg-white rounded-lg p-4 flex items-center gap-4 border border-indigo-100 shadow-lg animate-pulse">
                <div class="loader"></div>
                <div class="flex-grow">
                    <p id="statusText" class="text-sm font-bold text-indigo-600">AI AGENT IS READING...</p>
                    <p id="statusSub" class="text-xs text-gray-500">è³‡æ–™ã®å†…å®¹ã‚’è§£æã—ã¦ã„ã¾ã™...</p>
                </div>
            </div>
        </div>

        <!-- Step 2: Title Selection -->
        <section id="titlesSection" class="hidden fade-in max-w-5xl mx-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">
                    <span class="bg-indigo-600 text-white text-xs px-2 py-1 rounded mr-2">STEP 2</span>
                    è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«æ¡ˆã‚’é¸æŠ
                </h3>
                <button onclick="resetAll()" class="text-sm text-gray-500 hover:text-indigo-600 bg-white border border-gray-200 px-3 py-1 rounded">ã‚„ã‚Šç›´ã™</button>
            </div>
            <div id="titlesGrid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Titles injected here -->
            </div>
        </section>

        <!-- Step 3: Article Generation -->
        <section id="articleSection" class="hidden fade-in max-w-5xl mx-auto space-y-6">
            <div class="flex justify-start">
                <button onclick="backToTitles()" class="text-sm text-gray-500 hover:text-indigo-600 flex items-center gap-1 bg-white border border-gray-200 px-3 py-1 rounded transition-colors">
                    <span>â†</span> ã‚¿ã‚¤ãƒˆãƒ«é¸æŠã«æˆ»ã‚‹
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Outline -->
                <div class="space-y-2">
                    <div class="font-bold text-gray-700 border-b border-gray-200 pb-2">ğŸ“Š è¨˜äº‹æ§‹æˆæ¡ˆ</div>
                    <div class="glass-panel p-6 rounded-lg min-h-[400px] max-h-[600px] overflow-y-auto custom-scrollbar">
                        <div id="outlineContent" class="prose max-w-none text-sm"></div>
                    </div>
                </div>

                <!-- Body -->
                <div class="space-y-2">
                    <div class="flex justify-between items-center border-b border-gray-200 pb-2">
                        <div class="font-bold text-indigo-700">ğŸ“ è¨˜äº‹æœ¬æ–‡</div>
                        <button onclick="copyArticle()" class="text-xs bg-white border border-indigo-200 text-indigo-600 px-3 py-1 rounded hover:bg-indigo-50">å…¨æ–‡ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="glass-panel p-6 rounded-lg min-h-[400px] max-h-[600px] overflow-y-auto custom-scrollbar">
                        <div id="articleContent" class="prose max-w-none"></div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // --- State Management ---
        let globalPdfBase64 = null;
        let globalInputType = 'pdf'; 
        
        // --- API Key ---
        document.addEventListener('DOMContentLoaded', () => {
            switchTab('pdf');
            if (!localStorage.getItem('gemini_api_key')) {
                document.getElementById('apiKeyModal').classList.remove('hidden');
            }
        });

        function saveApiKey() {
            const key = document.getElementById('inputApiKey').value.trim();
            if (!key) return alert('APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
            localStorage.setItem('gemini_api_key', key);
            document.getElementById('apiKeyModal').classList.add('hidden');
        }

        function clearApiKey() {
            if(confirm('APIã‚­ãƒ¼ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                localStorage.removeItem('gemini_api_key');
                location.reload();
            }
        }

        // --- UI Logic ---
        function switchTab(type) {
            globalInputType = type;
            document.getElementById('tab-pdf').className = type === 'pdf' ? 'tab-active px-6 py-2 transition-colors w-1/2 md:w-auto' : 'tab-inactive px-6 py-2 transition-colors w-1/2 md:w-auto';
            document.getElementById('tab-text').className = type === 'text' ? 'tab-active px-6 py-2 transition-colors w-1/2 md:w-auto' : 'tab-inactive px-6 py-2 transition-colors w-1/2 md:w-auto';
            
            if(type === 'pdf') {
                document.getElementById('panel-pdf').classList.remove('hidden');
                document.getElementById('panel-text').classList.add('hidden');
            } else {
                document.getElementById('panel-pdf').classList.add('hidden');
                document.getElementById('panel-text').classList.remove('hidden');
            }
        }

        function handleFileSelect(input) {
            const file = input.files[0];
            if (file) {
                if (file.size > 10 * 1024 * 1024) {
                    alert("ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã™ãã¾ã™ï¼ˆ10MBä»¥ä¸‹æ¨å¥¨ï¼‰");
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(e) {
                    globalPdfBase64 = e.target.result.split(',')[1];
                    document.getElementById('fileLabel').innerHTML = `
                        <span class="text-4xl block mb-2">âœ…</span>
                        <span class="text-indigo-600 font-bold">${file.name}</span>
                        <p class="text-xs text-gray-400 mt-2">èª­ã¿è¾¼ã¿å®Œäº†</p>
                    `;
                };
                reader.readAsDataURL(file);
            }
        }

        function setStatus(loading, mainText) {
            const el = document.getElementById('statusSection');
            if(loading) {
                el.classList.remove('hidden');
                document.getElementById('statusText').innerText = mainText;
            } else {
                el.classList.add('hidden');
            }
        }

        function resetAll() {
            document.getElementById('inputSection').classList.remove('hidden');
            document.getElementById('titlesSection').classList.add('hidden');
            document.getElementById('articleSection').classList.add('hidden');
        }

        function backToTitles() {
            document.getElementById('articleSection').classList.add('hidden');
            document.getElementById('titlesSection').classList.remove('hidden');
        }

        // --- Gemini API (Flexible Model) ---
        async function callGemini(prompt, pdfData = null) {
            const apiKey = localStorage.getItem('gemini_api_key');
            if (!apiKey) {
                document.getElementById('apiKeyModal').classList.remove('hidden');
                throw new Error("API Key missing");
            }

            // UIã§é¸æŠã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«åã‚’ä½¿ç”¨
            const modelName = document.getElementById('modelSelect').value;
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${apiKey}`;
            
            let parts = [{ text: prompt }];
            
            if (pdfData) {
                parts.push({
                    inline_data: {
                        mime_type: "application/pdf",
                        data: pdfData
                    }
                });
            }

            const payload = { contents: [{ parts: parts }] };

            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                const err = await response.json();
                throw new Error(err.error?.message || "API Error");
            }

            const data = await response.json();
            if (!data.candidates || data.candidates.length === 0) {
                 throw new Error("AIã‹ã‚‰ã®å¿œç­”ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚");
            }
            return data.candidates[0].content.parts[0].text;
        }

        // --- Main Process: Step 1 (Analyze & Titles) ---
        async function analyzeSource() {
            const textInput = document.getElementById('rawText').value;
            
            if (globalInputType === 'pdf' && !globalPdfBase64) return alert("PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„");
            if (globalInputType === 'text' && !textInput) return alert("ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã™ã‚‹ã‹URLã®å†…å®¹ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„");

            document.getElementById('inputSection').classList.add('hidden');
            setStatus(true, "è³‡æ–™ã‚’è§£æä¸­... SEOã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æŠ½å‡ºã—ã¦ã„ã¾ã™");

            const prompt = `
            ã‚ãªãŸã¯ãƒ—ãƒ­ã®Webç·¨é›†è€…ã§ã™ã€‚
            æä¾›ã•ã‚ŒãŸè³‡æ–™ã®å†…å®¹ã‚’æ·±ãåˆ†æã—ã€
            æ¤œç´¢ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆSEOï¼‰ãŒèˆˆå‘³ã‚’æŒã¡ãã†ãªã€Œè¨˜äº‹ã®åˆ‡ã‚Šå£ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ï¼‰ã€ã‚’5ã¤ææ¡ˆã—ã¦ãã ã•ã„ã€‚

            ã€å‡ºåŠ›å½¢å¼ã€‘
            JSONé…åˆ—ã®ã¿ï¼ˆä¾‹: ["ã‚¿ã‚¤ãƒˆãƒ«æ¡ˆ1", "ã‚¿ã‚¤ãƒˆãƒ«æ¡ˆ2"...]ï¼‰
            Markdownã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‚„ä½™è¨ˆãªæ–‡ç« ã¯ä¸€åˆ‡å«ã‚ãªã„ã§ãã ã•ã„ã€‚
            `;

            try {
                const pdfPayload = (globalInputType === 'pdf') ? globalPdfBase64 : null;
                const finalPrompt = (globalInputType === 'text') ? `ã€è³‡æ–™ãƒ†ã‚­ã‚¹ãƒˆã€‘\n${textInput}\n\n${prompt}` : prompt;

                let response = await callGemini(finalPrompt, pdfPayload);
                
                // Clean response to extract JSON
                response = response.replace(/```json/g, '').replace(/```/g, '').trim();
                
                // Fallback: If AI includes text outside JSON, try to find the array
                const jsonMatch = response.match(/\[.*\]/s);
                if (jsonMatch) {
                    response = jsonMatch[0];
                }

                const titles = JSON.parse(response);

                renderTitles(titles);
                setStatus(false);
                document.getElementById('titlesSection').classList.remove('hidden');

            } catch (e) {
                alert("è§£æã‚¨ãƒ©ãƒ¼: " + e.message + "\n\nã€ãƒ’ãƒ³ãƒˆã€‘ç”»é¢ä¸Šéƒ¨ã®ãƒ¢ãƒ‡ãƒ«é¸æŠã§åˆ¥ã®ãƒ¢ãƒ‡ãƒ«ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚");
                resetAll();
                setStatus(false);
            }
        }

        function renderTitles(titles) {
            const grid = document.getElementById('titlesGrid');
            grid.innerHTML = "";
            titles.forEach((t, i) => {
                const div = document.createElement('div');
                div.className = "bg-white p-4 rounded-lg border border-gray-200 shadow-sm hover:border-indigo-500 hover:shadow-md cursor-pointer transition-all";
                div.innerHTML = `
                    <div class="text-xs text-indigo-500 font-bold mb-1">PLAN ${i+1}</div>
                    <div class="font-bold text-gray-800">${t}</div>
                `;
                div.onclick = () => generateArticle(t);
                grid.appendChild(div);
            });
        }

        // --- Main Process: Step 2 (Outline & Body) ---
        async function generateArticle(selectedTitle) {
            document.getElementById('titlesSection').classList.add('hidden');
            document.getElementById('articleSection').classList.remove('hidden');
            
            document.getElementById('outlineContent').innerHTML = '<div class="text-center text-gray-400 mt-10">æ§‹æˆæ¡ˆã‚’ä½œæˆä¸­...</div>';
            document.getElementById('articleContent').innerHTML = '<div class="text-center text-gray-400 mt-10">å¾…æ©Ÿä¸­...</div>';

            const textInput = document.getElementById('rawText').value;
            const pdfPayload = (globalInputType === 'pdf') ? globalPdfBase64 : null;

            try {
                // 1. Outline
                setStatus(true, "æ§‹æˆæ¡ˆã‚’ä½œæˆä¸­...");
                const outlinePrompt = `
                é¸æŠã•ã‚ŒãŸã‚¿ã‚¤ãƒˆãƒ«: ${selectedTitle}
                
                æä¾›ã•ã‚ŒãŸè³‡æ–™ã‚’å…ƒã«ã€ä¸Šè¨˜ã‚¿ã‚¤ãƒˆãƒ«ã®è¨˜äº‹ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ã€ŒSEOæ§‹æˆæ¡ˆã€ã‚’ä½œã£ã¦ãã ã•ã„ã€‚
                Markdownå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
                è³‡æ–™ã®å†…å®¹ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¤ã¤ã€èª­è€…ãŒèª­ã¿ã‚„ã™ã„ã‚ˆã†ã«æƒ…å ±ã‚’æ•´ç†ãƒ»è¦ç´„ãƒ»è£œè¶³ã—ã¦ãã ã•ã„ã€‚
                `;
                
                const finalOutlinePrompt = (globalInputType === 'text') ? `ã€è³‡æ–™ãƒ†ã‚­ã‚¹ãƒˆã€‘\n${textInput}\n\n${outlinePrompt}` : outlinePrompt;
                
                const outlineMd = await callGemini(finalOutlinePrompt, pdfPayload);
                document.getElementById('outlineContent').innerHTML = marked.parse(outlineMd);

                // 2. Body
                setStatus(true, "è¨˜äº‹æœ¬æ–‡ã‚’åŸ·ç­†ä¸­...");
                const bodyPrompt = `
                ä»¥ä¸‹ã®æ§‹æˆæ¡ˆã«å¾“ã£ã¦ã€è¨˜äº‹æœ¬æ–‡ã‚’åŸ·ç­†ã—ã¦ãã ã•ã„ã€‚
                
                ã€ã‚¿ã‚¤ãƒˆãƒ«ã€‘${selectedTitle}
                ã€æ§‹æˆæ¡ˆã€‘
                ${outlineMd}

                ã€åŸ·ç­†ãƒ«ãƒ¼ãƒ«ã€‘
                - æä¾›ã•ã‚ŒãŸè³‡æ–™ã®å†…å®¹ã‚’æ­£ç¢ºã«åæ˜ ã™ã‚‹ã“ã¨ã€‚
                - èª­ã¿ã‚„ã™ãã€å°‚é–€ç”¨èªã‚’å™›ã¿ç •ã„ã¦è§£èª¬ã™ã‚‹ã“ã¨ã€‚
                - Markdownå½¢å¼ã§å‡ºåŠ›ã€‚
                `;
                
                const finalBodyPrompt = (globalInputType === 'text') ? `ã€è³‡æ–™ãƒ†ã‚­ã‚¹ãƒˆã€‘\n${textInput}\n\n${bodyPrompt}` : bodyPrompt;
                
                const articleMd = await callGemini(finalBodyPrompt, pdfPayload);
                document.getElementById('articleContent').innerHTML = marked.parse(articleMd);

                setStatus(false);

            } catch (e) {
                alert("åŸ·ç­†ã‚¨ãƒ©ãƒ¼: " + e.message + "\n\nã€ãƒ’ãƒ³ãƒˆã€‘ç”»é¢ä¸Šéƒ¨ã®ãƒ¢ãƒ‡ãƒ«é¸æŠã§åˆ¥ã®ãƒ¢ãƒ‡ãƒ«ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚");
                setStatus(false);
            }
        }

        function copyArticle() {
            const content = document.getElementById('articleContent').innerText;
            navigator.clipboard.writeText(content).then(() => alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ"));
        }
    </script>
</body>
</html>
